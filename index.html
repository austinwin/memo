<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Journal</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#eef2f6" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <div class="header-title">
      <h1>Journal</h1>
      <p class="header-subtitle">Capture moments, reflect, and plan.</p>
    </div>
    <div class="header-actions">
      <input id="importInput" type="file" accept="application/json" hidden />
      <button id="mapHeaderBtn" class="btn secondary" type="button">Open map</button>
      <button id="importBtn" class="btn secondary" type="button">Import</button>
      <button id="exportBtn" class="btn secondary" type="button">Export</button>
    </div>
  </header>

  <main class="app-main">
    <section class="memo-form-section">
      <header class="memo-form-header">
        <div>
          <h2>New entry</h2>
          <p id="todayLabel" class="today-label"></p>
        </div>
        <button id="todayShortcutBtn" class="btn secondary" type="button">Jump to now</button>
      </header>
      <form id="memoForm" class="memo-form">
        <div class="form-row">
          <label>
            Title
            <input type="text" id="title" name="title" required maxlength="100" />
          </label>
          <label>
            Date & Time
            <input type="datetime-local" id="datetime" name="datetime" />
          </label>
        </div>
        <label>
          Text
          <textarea id="text" name="text" rows="5" required placeholder="What stood out about today?"></textarea>
        </label>
        <label class="todo-toggle">
          <span class="todo-toggle-label">Task</span>
          <span class="todo-toggle-help">Treat this memo as a toâ€‘do you want to track.</span>
          <div class="todo-toggle-control">
            <input type="checkbox" id="isTodo" name="isTodo" />
            <span>Track as task</span>
          </div>
        </label>
        <div class="form-location-row">
          <button type="button" id="locationBtn" class="btn secondary">Add location</button>
          <p id="locationSummary" class="location-summary" hidden></p>
        </div>
        <div class="form-mood-row">
          <div class="mood-picker" aria-label="Select mood for this entry">
            <button type="button" class="mood-btn" data-mood="great">ğŸ˜Š</button>
            <button type="button" class="mood-btn" data-mood="ok">ğŸ˜</button>
            <button type="button" class="mood-btn" data-mood="bad">ğŸ˜</button>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn primary">Save entry</button>
            <button type="reset" class="btn">Clear</button>
          </div>
        </div>
      </form>
    </section>

    <section class="memo-list-section">
      <div class="memo-list-header">
        <div class="memo-list-title">
          <h2>Your entries</h2>
          <p class="memo-list-subtitle">A calm place for your recent memories.</p>
        </div>
        <div class="memo-list-controls">
          <div class="memo-controls-row">
            <nav class="memo-tabs" aria-label="Filter memos">
              <button class="memo-tab active" data-tab="all" type="button">All</button>
              <button class="memo-tab" data-tab="today" type="button">Today</button>
              <button class="memo-tab" data-tab="pinned" type="button">Pinned</button>
              <button class="memo-tab" data-tab="tasks" type="button">Tasks</button>
              <button class="memo-tab" data-tab="map" type="button">Map</button>
            </nav>
            <select id="sortSelect" class="sort-select">
              <option value="newest">Newest first</option>
              <option value="oldest">Oldest first</option>
              <option value="title">Title Aâ€“Z</option>
            </select>
          </div>
          <div class="memo-controls-row">
            <div class="memo-search-group">
              <input
                id="searchInput"
                class="search-input"
                type="search"
                placeholder="Search entries"
                aria-label="Search entries"
              />
            </div>
            <div class="mood-filter" aria-label="Filter by mood" role="radiogroup">
              <button
                type="button"
                class="mood-filter-btn active"
                data-filter="mood"
                data-mood="all"
                role="radio"
                aria-pressed="true"
              >All moods</button>
              <button
                type="button"
                class="mood-filter-btn"
                data-filter="mood"
                data-mood="great"
                role="radio"
                aria-pressed="false"
              >ğŸ˜Š</button>
              <button
                type="button"
                class="mood-filter-btn"
                data-filter="mood"
                data-mood="ok"
                role="radio"
                aria-pressed="false"
              >ğŸ˜</button>
              <button
                type="button"
                class="mood-filter-btn"
                data-filter="mood"
                data-mood="bad"
                role="radio"
                aria-pressed="false"
              >ğŸ˜</button>
            </div>
          </div>
        </div>
      </div>
      <section class="memo-stats" aria-label="Writing statistics">
        <p class="memo-stats-item">
          <span class="memo-stats-label">Streak</span>
          <span id="streakCount" class="memo-stats-value">0 days</span>
        </p>
        <p class="memo-stats-item">
          <span class="memo-stats-label">This week</span>
          <span id="weekCount" class="memo-stats-value">0 entries</span>
        </p>
        <p class="memo-stats-item">
          <span class="memo-stats-label">Today's words</span>
          <span id="todayWords" class="memo-stats-value">0 words</span>
        </p>
        <p class="memo-stats-item">
          <span class="memo-stats-label">This week's words</span>
          <span id="weekWords" class="memo-stats-value">0 words</span>
        </p>
        <p class="memo-stats-item">
          <span class="memo-stats-label">Last entry</span>
          <span id="lastEntryLabel" class="memo-stats-value">None yet</span>
        </p>
      </section>
      <div id="memoList" class="memo-list"></div>
      <div id="mapShell" class="map-shell" hidden>
        <div id="mapToolbar" class="map-toolbar">
          <div class="map-toolbar-group map-toolbar-left">
            <button id="mapCloseBtn" class="btn ghost" type="button">Back to list</button>
            <span id="mapCountLabel" class="map-count">0 places</span>
          </div>
          <div class="map-toolbar-group map-toolbar-center">
            <input
              id="mapSearchInput"
              class="map-search-input"
              type="search"
              placeholder="Search on map"
              aria-label="Search map entries"
            />
          </div>
          <div class="map-toolbar-group map-toolbar-right">
            <div class="map-filter" aria-label="Filter map by mood" role="radiogroup">
              <button
                type="button"
                class="mood-filter-btn map-filter-btn active"
                data-filter="mood"
                data-mood="all"
                role="radio"
                aria-pressed="true"
              >All</button>
              <button
                type="button"
                class="mood-filter-btn map-filter-btn"
                data-filter="mood"
                data-mood="great"
                role="radio"
                aria-pressed="false"
              >ğŸ˜Š</button>
              <button
                type="button"
                class="mood-filter-btn map-filter-btn"
                data-filter="mood"
                data-mood="ok"
                role="radio"
                aria-pressed="false"
              >ğŸ˜</button>
              <button
                type="button"
                class="mood-filter-btn map-filter-btn"
                data-filter="mood"
                data-mood="bad"
                role="radio"
                aria-pressed="false"
              >ğŸ˜</button>
            </div>
            <select id="mapMarkerSelect" class="map-marker-select" aria-label="Map symbol style">
              <option value="pin">Pins</option>
              <option value="dot">Dots</option>
              <option value="emoji">Emoji</option>
            </select>
            <button id="mapRecenterBtn" class="btn ghost" type="button">Recenter</button>
          </div>
        </div>
        <div id="mapView" class="map-view"></div>
      </div>
    </section>
  </main>

  <div id="locationModal" class="modal" hidden>
    <div class="modal-content">
      <header class="modal-header">
        <h3>Select location</h3>
        <button type="button" id="locationModalClose" class="icon-btn">âœ•</button>
      </header>
      <div class="modal-body">
        <div id="locationMap" class="location-map"></div>
        <div class="location-controls">
          <button type="button" id="useCurrentLocationBtn" class="btn secondary">Use my current location</button>
          <input
            type="text"
            id="locationLabelInput"
            class="location-label-input"
            placeholder="Label (Home, Office, CafÃ©...)"
          />
        </div>
      </div>
      <footer class="modal-footer">
        <button type="button" id="locationClearBtn" class="btn">Remove</button>
        <button type="button" id="locationSaveBtn" class="btn primary">Save</button>
      </footer>
    </div>
  </div>

  <template id="memoTemplate">
    <article class="memo-card">
      <header class="memo-card-header">
        <div class="memo-title-group">
          <div class="memo-todo">
            <input type="checkbox" class="memo-todo-checkbox" aria-label="Mark task as done" />
          </div>
          <div>
            <h3 class="memo-title"></h3>
            <p class="memo-datetime"></p>
          </div>
        </div>
        <div class="memo-card-actions">
          <span class="memo-mood" aria-hidden="true"></span>
          <button class="icon-btn pin-btn" title="Pin or unpin">ğŸ“Œ</button>
          <button class="icon-btn edit-btn" title="Edit">âœï¸</button>
          <button class="icon-btn delete-btn" title="Delete">ğŸ—‘ï¸</button>
        </div>
      </header>
      <p class="memo-text"></p>
    </article>
  </template>

  <div id="toast" class="toast" hidden></div>

  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  <script src="location.js"></script>
  <script src="app.js"></script>
  <script src="pwa.js"></script>
</body>
</html>
